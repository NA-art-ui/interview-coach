<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InterviewAI Coach - Voice Interview Practice</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #00ff88;
            --primary-dark: #00cc6a;
            --secondary: #ff3366;
            --bg-dark: #0a0e17;
            --bg-card: #141922;
            --bg-elevated: #1e2533;
            --text-primary: #ffffff;
            --text-secondary: #8892a6;
            --text-muted: #4a5568;
            --accent-blue: #00d4ff;
            --accent-purple: #a855f7;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0, 255, 136, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 212, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(168, 85, 247, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            padding-top: 2rem;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--accent-blue));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: bold;
            font-family: 'Space Mono', monospace;
            box-shadow: 0 8px 32px rgba(0, 255, 136, 0.3);
        }

        h1 {
            font-size: 3.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }

        .tagline {
            font-size: 1.25rem;
            color: var(--text-secondary);
            font-weight: 300;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .card {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            border-color: rgba(0, 255, 136, 0.2);
            box-shadow: 0 12px 48px rgba(0, 255, 136, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .card-icon {
            width: 48px;
            height: 48px;
            background: var(--bg-elevated);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .card h2 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .category-select {
            display: grid;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .category-btn {
            background: var(--bg-elevated);
            border: 2px solid transparent;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Outfit', sans-serif;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .category-btn:hover {
            background: var(--bg-elevated);
            border-color: var(--primary);
            transform: translateX(4px);
        }

        .category-btn.active {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.15), rgba(0, 212, 255, 0.15));
            border-color: var(--primary);
        }

        .category-btn .emoji {
            font-size: 1.5rem;
        }

        .start-btn {
            width: 100%;
            padding: 1.25rem 2rem;
            background: linear-gradient(135deg, var(--primary), var(--accent-blue));
            border: none;
            border-radius: 12px;
            color: var(--bg-dark);
            font-size: 1.125rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Outfit', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 8px 24px rgba(0, 255, 136, 0.3);
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(0, 255, 136, 0.4);
        }

        .start-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .interview-interface {
            display: none;
        }

        .interview-interface.active {
            display: block;
        }

        .interview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .progress-info {
            display: flex;
            gap: 2rem;
            font-family: 'Space Mono', monospace;
        }

        .progress-item {
            display: flex;
            flex-direction: column;
        }

        .progress-label {
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .progress-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .end-interview-btn {
            padding: 0.75rem 1.5rem;
            background: var(--bg-elevated);
            border: 1px solid var(--secondary);
            border-radius: 8px;
            color: var(--secondary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .end-interview-btn:hover {
            background: var(--secondary);
            color: white;
        }

        .question-display {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .question-type {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: var(--bg-elevated);
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-family: 'Space Mono', monospace;
        }

        .question-text {
            font-size: 1.75rem;
            font-weight: 600;
            line-height: 1.4;
            margin-bottom: 1.5rem;
        }

        .question-hint {
            font-size: 1rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        .code-editor {
            background: #1e1e1e;
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .code-editor textarea {
            width: 100%;
            min-height: 200px;
            background: transparent;
            border: none;
            color: #d4d4d4;
            font-family: 'Space Mono', monospace;
            font-size: 0.95rem;
            resize: vertical;
            outline: none;
        }

        .voice-control {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .voice-btn {
            padding: 2rem;
            background: var(--bg-card);
            border: 2px solid transparent;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            font-family: 'Outfit', sans-serif;
        }

        .voice-btn:hover {
            border-color: var(--primary);
            transform: translateY(-4px);
        }

        .voice-btn.recording {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));
            border-color: var(--error);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .voice-icon {
            width: 80px;
            height: 80px;
            background: var(--bg-elevated);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
        }

        .voice-btn.recording .voice-icon {
            background: var(--error);
        }

        .voice-label {
            font-size: 1.125rem;
            font-weight: 600;
        }

        .voice-status {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .transcript {
            background: var(--bg-elevated);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            min-height: 120px;
            border-left: 4px solid var(--primary);
        }

        .transcript-label {
            font-size: 0.875rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            font-family: 'Space Mono', monospace;
        }

        .transcript-text {
            font-size: 1rem;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .evaluation {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .score-display {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--bg-elevated);
            border-radius: 12px;
        }

        .score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            font-family: 'Space Mono', monospace;
            position: relative;
        }

        .score-circle.excellent {
            background: linear-gradient(135deg, var(--success), var(--primary));
        }

        .score-circle.good {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
        }

        .score-circle.fair {
            background: linear-gradient(135deg, var(--warning), #fbbf24);
        }

        .score-circle.poor {
            background: linear-gradient(135deg, var(--error), var(--secondary));
        }

        .score-details {
            flex: 1;
        }

        .score-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .score-subtitle {
            color: var(--text-secondary);
        }

        .feedback-section {
            margin-top: 1.5rem;
        }

        .feedback-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .feedback-list {
            list-style: none;
            display: grid;
            gap: 0.75rem;
        }

        .feedback-list li {
            padding: 1rem;
            background: var(--bg-elevated);
            border-radius: 8px;
            border-left: 3px solid var(--primary);
        }

        .feedback-list.improvements li {
            border-left-color: var(--warning);
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 2rem;
        }

        .action-btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Outfit', sans-serif;
        }

        .action-btn.primary {
            background: linear-gradient(135deg, var(--primary), var(--accent-blue));
            color: var(--bg-dark);
        }

        .action-btn.secondary {
            background: var(--bg-elevated);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .action-btn:hover {
            transform: translateY(-2px);
        }

        .final-report {
            display: none;
        }

        .final-report.active {
            display: block;
        }

        .report-header {
            text-align: center;
            padding: 3rem 2rem;
            background: var(--bg-card);
            border-radius: 24px;
            margin-bottom: 2rem;
        }

        .report-score {
            font-size: 5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .report-title {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            padding: 1.5rem;
            border-radius: 16px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            font-family: 'Space Mono', monospace;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid var(--bg-elevated);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .voice-control {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            h1 {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">AI</div>
            </div>
            <h1>InterviewAI Coach</h1>
            <p class="tagline">Master your interviews with AI-powered voice practice</p>
        </header>

        <!-- Setup Section -->
        <div id="setupSection">
            <div class="main-grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üíº</div>
                        <h2>Interview Type</h2>
                    </div>
                    <div class="category-select">
                        <button class="category-btn active" data-category="behavioral">
                            <span class="emoji">üó£Ô∏è</span>
                            <span>Behavioral Questions</span>
                        </button>
                        <button class="category-btn" data-category="technical">
                            <span class="emoji">‚öôÔ∏è</span>
                            <span>Technical Interview</span>
                        </button>
                        <button class="category-btn" data-category="coding">
                            <span class="emoji">üíª</span>
                            <span>Coding Challenge</span>
                        </button>
                        <button class="category-btn" data-category="leadership">
                            <span class="emoji">üë•</span>
                            <span>Leadership & Management</span>
                        </button>
                        <button class="category-btn" data-category="mixed">
                            <span class="emoji">üéØ</span>
                            <span>Mixed Interview (Recommended)</span>
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">‚öôÔ∏è</div>
                        <h2>Settings</h2>
                    </div>
                    <div style="display: grid; gap: 1rem;">
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Number of Questions</label>
                            <input type="number" id="numQuestions" value="5" min="3" max="10" 
                                   style="width: 100%; padding: 0.75rem; background: var(--bg-elevated); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: var(--text-primary); font-family: 'Outfit', sans-serif; font-size: 1rem;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">Difficulty Level</label>
                            <select id="difficulty" 
                                    style="width: 100%; padding: 0.75rem; background: var(--bg-elevated); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: var(--text-primary); font-family: 'Outfit', sans-serif; font-size: 1rem; cursor: pointer;">
                                <option value="entry">Entry Level</option>
                                <option value="mid" selected>Mid Level</option>
                                <option value="senior">Senior Level</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <button class="start-btn" id="startBtn">Start Interview Practice</button>
            </div>
        </div>

        <!-- Interview Interface -->
        <div id="interviewInterface" class="interview-interface">
            <div class="interview-header">
                <div class="progress-info">
                    <div class="progress-item">
                        <span class="progress-label">Question</span>
                        <span class="progress-value" id="currentQuestion">1</span>
                    </div>
                    <div class="progress-item">
                        <span class="progress-label">of</span>
                        <span class="progress-value" id="totalQuestions">5</span>
                    </div>
                    <div class="progress-item">
                        <span class="progress-label">Category</span>
                        <span class="progress-value" id="currentCategory" style="font-size: 1rem; text-transform: uppercase;">Behavioral</span>
                    </div>
                </div>
                <button class="end-interview-btn" id="endBtn">End Interview</button>
            </div>

            <div class="question-display" id="questionDisplay">
                <div class="question-type" id="questionType">BEHAVIORAL</div>
                <div class="question-text" id="questionText">Loading question...</div>
                <div class="question-hint" id="questionHint"></div>
                <div class="code-editor" id="codeEditor" style="display: none;">
                    <textarea id="codeInput" placeholder="// Write your code here..."></textarea>
                </div>
            </div>

            <div class="voice-control">
                <button class="voice-btn" id="listenBtn">
                    <div class="voice-icon">üé§</div>
                    <div class="voice-label">Listen to Question</div>
                    <div class="voice-status">Click to hear the question</div>
                </button>
                <button class="voice-btn" id="recordBtn">
                    <div class="voice-icon">üî¥</div>
                    <div class="voice-label">Record Answer</div>
                    <div class="voice-status">Click to start recording</div>
                </button>
            </div>

            <div class="transcript">
                <div class="transcript-label">YOUR ANSWER TRANSCRIPT:</div>
                <div class="transcript-text" id="transcriptText">Your answer will appear here as you speak...</div>
            </div>

            <div class="evaluation" id="evaluationSection" style="display: none;">
                <div class="score-display">
                    <div class="score-circle" id="scoreCircle">
                        <span id="scoreValue">0</span>/10
                    </div>
                    <div class="score-details">
                        <div class="score-title" id="scoreTitle">Evaluating...</div>
                        <div class="score-subtitle" id="scoreSubtitle">Please wait while AI analyzes your answer</div>
                    </div>
                </div>
                <div id="feedbackContent"></div>
                <div class="action-buttons">
                    <button class="action-btn secondary" id="retryBtn">‚Üª Retry This Question</button>
                    <button class="action-btn primary" id="nextBtn">Next Question ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Final Report -->
        <div id="finalReport" class="final-report">
            <div class="report-header">
                <div class="report-score" id="finalScore">0%</div>
                <h2 class="report-title" id="reportTitle">Interview Complete!</h2>
                <p class="tagline" id="reportSubtitle">Here's your performance summary</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="avgScore">0</div>
                    <div class="stat-label">Average Score</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="questionsAnswered">0</div>
                    <div class="stat-label">Questions Answered</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="bestScore">0</div>
                    <div class="stat-label">Best Score</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="timeSpent">0m</div>
                    <div class="stat-label">Time Spent</div>
                </div>
            </div>

            <div class="card" id="detailedFeedback">
                <h2 style="margin-bottom: 1.5rem;">Detailed Performance Report</h2>
                <div id="reportContent"></div>
            </div>

            <div class="action-buttons">
                <button class="action-btn secondary" onclick="location.reload()">‚Üê Start New Interview</button>
                <button class="action-btn primary" id="downloadReport">Download Report PDF</button>
            </div>
        </div>
    </div>

    <script>
        // Interview Questions Database
        const questionDatabase = {
            behavioral: [
                {
                    question: "Tell me about a time when you faced a significant challenge at work and how you overcame it.",
                    hint: "Use the STAR method: Situation, Task, Action, Result",
                    type: "behavioral"
                },
                {
                    question: "Describe a situation where you had to work with a difficult team member. How did you handle it?",
                    hint: "Focus on conflict resolution and collaboration skills",
                    type: "behavioral"
                },
                {
                    question: "Tell me about a time when you failed. What did you learn from it?",
                    hint: "Show self-awareness and growth mindset",
                    type: "behavioral"
                },
                {
                    question: "Give me an example of when you had to meet a tight deadline. How did you manage your time?",
                    hint: "Demonstrate time management and prioritization",
                    type: "behavioral"
                },
                {
                    question: "Describe a time when you had to adapt to a major change at work.",
                    hint: "Show flexibility and resilience",
                    type: "behavioral"
                }
            ],
            technical: [
                {
                    question: "Explain the difference between REST and GraphQL APIs. When would you use one over the other?",
                    hint: "Discuss use cases, advantages, and trade-offs",
                    type: "technical"
                },
                {
                    question: "What is the difference between SQL and NoSQL databases? Give examples of when to use each.",
                    hint: "Focus on data structure, scalability, and use cases",
                    type: "technical"
                },
                {
                    question: "Explain how you would optimize the performance of a slow web application.",
                    hint: "Mention caching, database optimization, CDN, code splitting",
                    type: "technical"
                },
                {
                    question: "What is CI/CD and why is it important in modern software development?",
                    hint: "Explain continuous integration and deployment benefits",
                    type: "technical"
                },
                {
                    question: "Describe the concept of microservices architecture and its advantages over monolithic architecture.",
                    hint: "Discuss scalability, deployment, and maintenance",
                    type: "technical"
                }
            ],
            coding: [
                {
                    question: "Write a function to reverse a string without using built-in reverse methods.",
                    hint: "Think about iterating through the string",
                    type: "coding",
                    isCode: true
                },
                {
                    question: "Write a function to find the first non-repeating character in a string.",
                    hint: "Consider using a hash map to count character frequencies",
                    type: "coding",
                    isCode: true
                },
                {
                    question: "Implement a function to check if a number is prime.",
                    hint: "Optimize by only checking up to the square root",
                    type: "coding",
                    isCode: true
                },
                {
                    question: "Write a function to merge two sorted arrays into one sorted array.",
                    hint: "Use two pointers approach",
                    type: "coding",
                    isCode: true
                },
                {
                    question: "Create a function to find the maximum sum of a contiguous subarray.",
                    hint: "Kadane's algorithm is efficient for this",
                    type: "coding",
                    isCode: true
                }
            ],
            leadership: [
                {
                    question: "How do you motivate a team that is facing low morale?",
                    hint: "Discuss empathy, communication, and recognition",
                    type: "leadership"
                },
                {
                    question: "Describe your approach to delegating tasks to team members.",
                    hint: "Consider strengths, development opportunities, and trust",
                    type: "leadership"
                },
                {
                    question: "How do you handle disagreements within your team?",
                    hint: "Focus on mediation, active listening, and finding common ground",
                    type: "leadership"
                },
                {
                    question: "What is your strategy for developing junior team members?",
                    hint: "Mention mentoring, feedback, and growth opportunities",
                    type: "leadership"
                },
                {
                    question: "How do you balance meeting business goals with maintaining team wellbeing?",
                    hint: "Discuss sustainable pace, communication, and prioritization",
                    type: "leadership"
                }
            ]
        };

        // State management
        let currentState = {
            category: 'behavioral',
            difficulty: 'mid',
            numQuestions: 5,
            currentQuestionIndex: 0,
            questions: [],
            answers: [],
            scores: [],
            startTime: null,
            isRecording: false,
            recognition: null,
            synthesis: window.speechSynthesis
        };

        // Initialize Speech Recognition
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (SpeechRecognition) {
            currentState.recognition = new SpeechRecognition();
            currentState.recognition.continuous = true;
            currentState.recognition.interimResults = true;
            currentState.recognition.lang = 'en-US';
        }

        // Setup event listeners
        document.addEventListener('DOMContentLoaded', () => {
            setupCategorySelection();
            setupStartButton();
            setupVoiceControls();
            setupActionButtons();
        });

        function setupCategorySelection() {
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentState.category = btn.dataset.category;
                });
            });
        }

        function setupStartButton() {
            document.getElementById('startBtn').addEventListener('click', startInterview);
        }

        function startInterview() {
            currentState.numQuestions = parseInt(document.getElementById('numQuestions').value);
            currentState.difficulty = document.getElementById('difficulty').value;
            currentState.startTime = Date.now();
            currentState.currentQuestionIndex = 0;
            currentState.answers = [];
            currentState.scores = [];

            // Generate questions
            generateQuestions();

            // Switch to interview interface
            document.getElementById('setupSection').style.display = 'none';
            document.getElementById('interviewInterface').classList.add('active');

            // Load first question
            loadQuestion();
        }

        function generateQuestions() {
            let questions = [];
            
            if (currentState.category === 'mixed') {
                // Mix questions from all categories
                const categories = ['behavioral', 'technical', 'coding', 'leadership'];
                for (let i = 0; i < currentState.numQuestions; i++) {
                    const category = categories[i % categories.length];
                    const pool = questionDatabase[category];
                    const question = pool[Math.floor(Math.random() * pool.length)];
                    questions.push({...question, category});
                }
            } else {
                // Get questions from selected category
                const pool = questionDatabase[currentState.category];
                const shuffled = [...pool].sort(() => Math.random() - 0.5);
                questions = shuffled.slice(0, currentState.numQuestions);
            }
            
            currentState.questions = questions;
        }

        function loadQuestion() {
            const question = currentState.questions[currentState.currentQuestionIndex];
            
            document.getElementById('currentQuestion').textContent = currentState.currentQuestionIndex + 1;
            document.getElementById('totalQuestions').textContent = currentState.numQuestions;
            document.getElementById('currentCategory').textContent = question.type.toUpperCase();
            document.getElementById('questionType').textContent = question.type.toUpperCase();
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('questionHint').textContent = question.hint;
            document.getElementById('transcriptText').textContent = 'Your answer will appear here as you speak...';
            document.getElementById('evaluationSection').style.display = 'none';
            
            // Show/hide code editor
            if (question.isCode) {
                document.getElementById('codeEditor').style.display = 'block';
                document.getElementById('codeInput').value = '';
            } else {
                document.getElementById('codeEditor').style.display = 'none';
            }
        }

        function setupVoiceControls() {
            const listenBtn = document.getElementById('listenBtn');
            const recordBtn = document.getElementById('recordBtn');

            listenBtn.addEventListener('click', speakQuestion);
            recordBtn.addEventListener('click', toggleRecording);

            if (currentState.recognition) {
                currentState.recognition.onresult = (event) => {
                    let transcript = '';
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        transcript += event.results[i][0].transcript;
                    }
                    document.getElementById('transcriptText').textContent = transcript;
                };

                currentState.recognition.onerror = (event) => {
                    console.error('Speech recognition error:', event.error);
                    if (currentState.isRecording) {
                        toggleRecording();
                    }
                };
            }
        }

        function speakQuestion() {
            const question = currentState.questions[currentState.currentQuestionIndex];
            const utterance = new SpeechSynthesisUtterance(question.question);
            utterance.rate = 0.9;
            utterance.pitch = 1;
            currentState.synthesis.speak(utterance);
        }

        function toggleRecording() {
            const recordBtn = document.getElementById('recordBtn');
            
            if (!currentState.recognition) {
                alert('Speech recognition is not supported in your browser. Please use Chrome or Edge.');
                return;
            }

            if (currentState.isRecording) {
                // Stop recording
                currentState.recognition.stop();
                currentState.isRecording = false;
                recordBtn.classList.remove('recording');
                recordBtn.querySelector('.voice-status').textContent = 'Click to start recording';
                
                // Evaluate answer
                setTimeout(() => evaluateAnswer(), 500);
            } else {
                // Start recording
                currentState.recognition.start();
                currentState.isRecording = true;
                recordBtn.classList.add('recording');
                recordBtn.querySelector('.voice-status').textContent = 'Recording... Click to stop';
                document.getElementById('transcriptText').textContent = '';
            }
        }

        async function evaluateAnswer() {
            const question = currentState.questions[currentState.currentQuestionIndex];
            const answer = document.getElementById('transcriptText').textContent;
            const codeAnswer = question.isCode ? document.getElementById('codeInput').value : '';
            
            if (!answer || answer === 'Your answer will appear here as you speak...') {
                alert('Please record an answer before continuing.');
                return;
            }

            // Show evaluation section with loading state
            document.getElementById('evaluationSection').style.display = 'block';
            document.getElementById('scoreCircle').className = 'score-circle';
            document.getElementById('scoreValue').textContent = '...';
            document.getElementById('scoreTitle').textContent = 'Evaluating...';
            document.getElementById('scoreSubtitle').textContent = 'AI is analyzing your answer';
            document.getElementById('feedbackContent').innerHTML = '<div class="loading"><div class="spinner"></div><span>Analyzing your response...</span></div>';

            try {
                // Call Claude API for evaluation
                const evaluation = await callClaudeAPI(question, answer, codeAnswer);
                displayEvaluation(evaluation);
                
                // Store answer and score
                currentState.answers.push({
                    question: question.question,
                    answer: answer,
                    code: codeAnswer,
                    evaluation: evaluation
                });
                currentState.scores.push(evaluation.score);
            } catch (error) {
                console.error('Evaluation error:', error);
                document.getElementById('feedbackContent').innerHTML = '<p style="color: var(--error);">Error evaluating answer. Please try again.</p>';
            }
        }

        async function callClaudeAPI(question, answer, codeAnswer) {
            const prompt = `You are an expert technical interviewer evaluating a candidate's answer.

Question Type: ${question.type}
Question: ${question.question}
${question.hint ? `Hint: ${question.hint}` : ''}

Candidate's Answer: ${answer}
${codeAnswer ? `\nCode Submitted:\n${codeAnswer}` : ''}

Please evaluate this answer and provide:
1. A score from 1-10
2. What was good about the answer (2-3 specific points)
3. What could be improved (2-3 specific points)
4. A suggested better answer or key points they missed

Respond in JSON format:
{
  "score": <number 1-10>,
  "strengths": ["point1", "point2", "point3"],
  "improvements": ["point1", "point2", "point3"],
  "betterAnswer": "suggested improvements or complete better answer"
}`;

            const response = await fetch("https://api.anthropic.com/v1/messages", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    model: "claude-sonnet-4-20250514",
                    max_tokens: 1000,
                    messages: [
                        { role: "user", content: prompt }
                    ],
                })
            });

            const data = await response.json();
            const content = data.content[0].text;
            
            // Parse JSON response
            const jsonMatch = content.match(/\{[\s\S]*\}/);
            if (jsonMatch) {
                return JSON.parse(jsonMatch[0]);
            }
            
            // Fallback if JSON parsing fails
            return {
                score: 7,
                strengths: ["Your answer addressed the question", "You provided context"],
                improvements: ["Could provide more specific examples", "Could elaborate on the results"],
                betterAnswer: "Consider using the STAR method and providing more quantifiable results."
            };
        }

        function displayEvaluation(evaluation) {
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreValue = document.getElementById('scoreValue');
            const scoreTitle = document.getElementById('scoreTitle');
            const scoreSubtitle = document.getElementById('scoreSubtitle');
            
            // Set score
            scoreValue.textContent = evaluation.score;
            
            // Set score class and title
            if (evaluation.score >= 8) {
                scoreCircle.className = 'score-circle excellent';
                scoreTitle.textContent = 'Excellent Answer!';
                scoreSubtitle.textContent = 'You demonstrated strong understanding';
            } else if (evaluation.score >= 6) {
                scoreCircle.className = 'score-circle good';
                scoreTitle.textContent = 'Good Answer';
                scoreSubtitle.textContent = 'Solid response with room for improvement';
            } else if (evaluation.score >= 4) {
                scoreCircle.className = 'score-circle fair';
                scoreTitle.textContent = 'Fair Answer';
                scoreSubtitle.textContent = 'Needs more detail and structure';
            } else {
                scoreCircle.className = 'score-circle poor';
                scoreTitle.textContent = 'Needs Improvement';
                scoreSubtitle.textContent = 'Let\'s work on strengthening your response';
            }
            
            // Display feedback
            const feedbackHTML = `
                <div class="feedback-section">
                    <div class="feedback-title">‚úÖ Strengths</div>
                    <ul class="feedback-list">
                        ${evaluation.strengths.map(s => `<li>${s}</li>`).join('')}
                    </ul>
                </div>
                <div class="feedback-section">
                    <div class="feedback-title">üí° Areas for Improvement</div>
                    <ul class="feedback-list improvements">
                        ${evaluation.improvements.map(i => `<li>${i}</li>`).join('')}
                    </ul>
                </div>
                <div class="feedback-section">
                    <div class="feedback-title">üéØ Better Answer Approach</div>
                    <div style="padding: 1rem; background: var(--bg-elevated); border-radius: 8px; margin-top: 0.5rem;">
                        ${evaluation.betterAnswer}
                    </div>
                </div>
            `;
            
            document.getElementById('feedbackContent').innerHTML = feedbackHTML;
        }

        function setupActionButtons() {
            document.getElementById('retryBtn').addEventListener('click', () => {
                document.getElementById('evaluationSection').style.display = 'none';
                document.getElementById('transcriptText').textContent = 'Your answer will appear here as you speak...';
                if (currentState.questions[currentState.currentQuestionIndex].isCode) {
                    document.getElementById('codeInput').value = '';
                }
            });

            document.getElementById('nextBtn').addEventListener('click', () => {
                currentState.currentQuestionIndex++;
                
                if (currentState.currentQuestionIndex >= currentState.numQuestions) {
                    showFinalReport();
                } else {
                    loadQuestion();
                }
            });

            document.getElementById('endBtn').addEventListener('click', () => {
                if (confirm('Are you sure you want to end the interview?')) {
                    showFinalReport();
                }
            });
        }

        function showFinalReport() {
            document.getElementById('interviewInterface').classList.remove('active');
            document.getElementById('finalReport').classList.add('active');
            
            const totalTime = Math.round((Date.now() - currentState.startTime) / 60000);
            const avgScore = currentState.scores.length > 0 
                ? (currentState.scores.reduce((a, b) => a + b, 0) / currentState.scores.length).toFixed(1)
                : 0;
            const bestScore = currentState.scores.length > 0 ? Math.max(...currentState.scores) : 0;
            const percentage = ((avgScore / 10) * 100).toFixed(0);
            
            document.getElementById('finalScore').textContent = percentage + '%';
            document.getElementById('avgScore').textContent = avgScore;
            document.getElementById('questionsAnswered').textContent = currentState.answers.length;
            document.getElementById('bestScore').textContent = bestScore;
            document.getElementById('timeSpent').textContent = totalTime + 'm';
            
            // Set report title based on performance
            if (avgScore >= 8) {
                document.getElementById('reportTitle').textContent = 'Outstanding Performance! üéâ';
                document.getElementById('reportSubtitle').textContent = 'You\'re ready to ace your interviews!';
            } else if (avgScore >= 6) {
                document.getElementById('reportTitle').textContent = 'Great Job! üëç';
                document.getElementById('reportSubtitle').textContent = 'Keep practicing to reach excellence';
            } else {
                document.getElementById('reportTitle').textContent = 'Good Start! üí™';
                document.getElementById('reportSubtitle').textContent = 'Practice makes perfect - keep going!';
            }
            
            // Generate detailed report
            generateDetailedReport();
        }

        function generateDetailedReport() {
            let reportHTML = '';
            
            currentState.answers.forEach((answer, index) => {
                const score = answer.evaluation.score;
                const scoreClass = score >= 8 ? 'excellent' : score >= 6 ? 'good' : score >= 4 ? 'fair' : 'poor';
                
                reportHTML += `
                    <div style="margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-elevated); border-radius: 12px; border-left: 4px solid var(--${scoreClass === 'excellent' ? 'success' : scoreClass === 'good' ? 'primary' : scoreClass === 'fair' ? 'warning' : 'error'});">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                            <h3 style="font-size: 1.125rem;">Question ${index + 1}</h3>
                            <span style="font-size: 1.5rem; font-weight: bold; color: var(--primary);">${score}/10</span>
                        </div>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">${currentState.questions[index].question}</p>
                        <div style="font-size: 0.875rem; color: var(--text-muted);">
                            <strong>Your Answer:</strong> ${answer.answer.substring(0, 200)}${answer.answer.length > 200 ? '...' : ''}
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('reportContent').innerHTML = reportHTML || '<p>No questions answered yet.</p>';
        }
    </script>
</body>
</html>
